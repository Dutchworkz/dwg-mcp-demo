# DWG.MCP

The journey to implement a Model Context Protocol (MCP) server in C#.

## How to start
Go to chatgpt and use the following prompt:
```
Give me 10 simple and practical ideas for implementing an MCP (Model Context Protocol) server, assuming the MCP server runs as a server-side element.

For each idea, include:

A short description of the server function

A realistic example input (such as a user message)

A sample MCP-style JSON response payload that the server would return

The goal is to demonstrate how the server can support a chat agent using a tool-handling architecture (agent ↔ MCP server ↔ tool). Keep it lightweight, modular, and practical.
```

## Example MCP Server Implementation

Use 1 of the ideas generated by the prompt above to implement a simple MCP server in C# or use your own idea. For reference, you can use the following example:

https://github.com/Dutchworkz/dwg-mcp-example

Changes have to be made in the following projects:
- `DWG.MCP.SSE`: This is the main server project that implements the MCP server functionality packages and functionality needs to be added.
- `DWG.MCP.Client.Web`: Implement the IMcpClient correctly and start building.

If you do nothing the solution will just start and run the server, but it will not do anything useful.


## Important Notes!!!
This sample project is not a full implementation of MCP. It is a simple example to demonstrate how to implement an MCP server in C#. Also it references an
external OpenAI service which is in the appsettings.Development.json file. You can use your own OpenAI API key or any other service that supports MCP.

If you're lucky enough maybe the key will still work, otherwise you have to get your own key.

```
  "ConnectionStrings": {
    "openAi": "Endpoint=.....;"
  },
  "openAiModel" :  "gpt41"
```

## MCP Enablement Steps

Follow these minimal steps (see the reference repo: https://github.com/Dutchworkz/dwg-mcp-example) to wire MCP capability into this solution:

1. Update `DWG.MCP.SSE` to use the correct ModelContextProtocol.AspnetCore package.

2. Update `DWG.MCP.SSE/Program.cs` to map (register) the MCP server(s).
  - Add the code that discovers/loads your MCP tools or server endpoints.
  - This typically includes adding any required service registrations before building the app.

3. In the same project (`DWG.MCP.SSE`), add a static class decorated with `[McpServerToolType]`.
  - Each public (async) method in that class becomes an MCP tool.
  - Keep it small first (e.g. a `PingAsync` method) so you can verify discovery works.

4. Change in the project (`DWG.MCP.Client`) `Program.cs` again to register an `IMcpClient` implementation (remove the nullable `?`).
  - Replace the existing nullable registration with a concrete implementation.
  
5. Modify `Chat.razor` to use the MCP client directly and update the system prompt.
  - Replace `@inject IServiceProvider ServiceProvider` with `@inject IMcpClient McpClient`.
  - Adjust initialization to call `await McpClient.ListToolsAsync()` and assign the tools to `chatOptions.Tools`.
  - Change the system prompt so it no longer instructs you to modify the file; instead prompt the assistant to selectively use available MCP tools.

After completing these five steps you should be able to start the solution, open the chat UI, and have tool metadata flow into the model prompts so that tool calls become possible.
